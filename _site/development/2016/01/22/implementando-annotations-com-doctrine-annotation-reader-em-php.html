<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>Implementando annotations com doctrine annotation reader em PHP | Leonardo Rifeli</title>
	<meta name="description" content="Saudações méros mortais, primeiro, peço desculpas pelo período sem trazer novidades para vocês (estive em uma excursão pela galáxia), em breve escreverei um ...">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="//assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/development/2016/01/22/implementando-annotations-com-doctrine-annotation-reader-em-php.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Leonardo Rifeli" href="/feed.xml" />

	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.js"></script>
	

	<!-- Google Analytics -->
	
</head>

  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="//">
			<img class="avatar" src="//assets/img/avatar.png" alt=""/>
		</a>
		
		<h1 class="site-title">
			<a href="http://localhost:4000/">Leonardo Rifeli</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled -->
			










<li>
	<a href="https://www.facebook.com/leonardorifeli" title="Follow on Facebook">
		<i class="fa fa-fw fa-facebook"></i>
	</a>
</li>





<li>
	<a href="https://github.com/leonardorifeli" title="Follow on GitHub">
		<i class="fa fa-fw fa-github"></i>
	</a>
</li>







<li>
	<a href="https://br.linkedin.com/in/leonardorifeli" title="Follow on LinkedIn">
		<i class="fa fa-fw fa-linkedin"></i>
	</a>
</li>

















<li>
	<a href="https://twitter.com/leonardorifeli" title="Follow on Twitter">
		<i class="fa fa-fw fa-twitter"></i>
	</a>
</li>






		</ul>
	</nav>
</header>

    <div class="content">
      <article >
  <header style="background-image: url('//')">
    <h1 class="title">Implementando annotations com doctrine annotation reader em PHP</h1>
    
    <p class="meta">
      January 22, 2016
       - Leonardo Rifeli
    </p>
  </header>
  <section class="post-content"><p>Saudações méros mortais, primeiro, peço desculpas pelo período sem trazer novidades para vocês (estive em uma excursão pela galáxia), em breve escreverei um artigo sobre essa viagem. Neste artigo mostrarei sobre <strong>annotations</strong> (é claro, está no título).</p>

<p>Como disse meu amigo <a href="https://medium.com/@guidiego" target="_blank">Guilherme Diego</a> no artigo <a href="https://medium.com/@guidiego/c%C3%B3digo-limpo-%C3%A9-uma-responsabilidade-blocos-5be1fdd8d341#.gbx5keq0s" target="_blank">Código Limpo é uma Responsabilidade — Blocos</a>:</p>

<p class="center"><img src="/img/posts/2016-01-custom-annotations/ler-curtir-compartilhar.png" alt="alt text" title="Share the post." /></p>

<p>Enquanto escrevo, vou ouvindo o álbum <a href="https://open.spotify.com/album/6iJEtgHTEbVlSS5isIS71z" target="_blank">As Daylight Dies</a> da banda Killswitch Engage, é um banda muito bacana.</p>

<p>Enfim, vamos ao que interessa, vem comigo.</p>

<h2 id="introdução">Introdução</h2>

<p>Em um projeto recente do qual participei do processo de <strong>refactoring</strong>, o que me auxiliou bastante, foi a implementação de <strong>annotations</strong>, onde foi possível segregar informações estáticas e até atingir algumas práticas de <strong>clean code</strong>, salientando que isso foi uma solução que funcionou bem no respectivo projeto.</p>

<p>Neste artigo eu não discutirei se é o correto, ou não, apenas demonstrarei como implementar <strong>custom annotations</strong> com o <strong>doctrine reader</strong>. Fica sobre teu critério meu chapa!</p>

<h2 id="escopo">Escopo</h2>

<p>No exemplo que mostrarei, utilizaremos os seguintes arquivos:</p>

<ol>
  <li><strong>compose.json</strong>: Dependência e informações do projeto;</li>
  <li><strong>PeopleAnnotation.php</strong>: Será a nossa annotation, utilizaremos os atributos para receber valores de quem irá consumir a <strong>annotation</strong>;</li>
  <li><strong>People.php</strong>: Iremos consumir nossa annotation e informar os respectivos valores para segregarmos informações;</li>
  <li><strong>ReaderAnnotation.php</strong>: Neste arquivo iremos juntar tudo e fazer uma sopa de letrinhas.</li>
</ol>

<p>Irei demonstrar os códigos no artigo, caso necessário, você poderá verificar no <a href="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9" target="_blank">Gist</a>.</p>

<h2 id="dependência-sim-você-precisará-dela">Dependência, sim você precisará dela.</h2>

<p>Para trabalhar com o <strong>Doctrine Annotation Reader</strong>, será necessário possuir a dependência <strong>“doctrine/common”</strong>, conforme o arquivo <strong>composer.json</strong> abaixo:</p>

<script src="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9.js?file=composer.json"></script>

<p><span class="space"> </span></p>

<h2 id="desenvolvendo-a-classe-da-annotation">Desenvolvendo a classe da annotation.</h2>

<p>Resumindo, esta classe será responsável pela <strong>annotation</strong>, ou seja, os atributos <strong>públicos</strong> da classe armazenarão informações que poderão ser informadas por quem irá consumir a <strong>annotation</strong> em questão. Segue abaixo o arquivo <strong>PeopleAnnotation.php</strong>, é a nossa annotation:</p>

<script src="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9.js?file=PeopleAnnotation.php"></script>

<p><span class="space"> </span></p>

<p>Repare que, a classe em questão possui uma <strong>annotation</strong>, sendo ela <strong>@Annotation</strong>, isto é necessário para informar ao <strong>Doctrine Annotation Reader</strong> que a classe em questão, realmente é uma <strong>annotation</strong>.</p>

<h2 id="consumindo-a-annotation">Consumindo a annotation</h2>

<p class="center"><img src="/img/posts/2016-01-custom-annotations/consumindo.gif" alt="alt text" title="Using the annotation PeopleAnnotation" /></p>

<p>Nesta etapa, iremos consumir a annotation <strong>PeopleAnnotation</strong> e informaremos os valores que a annotation disponibiliza.</p>

<p>Salientando, é possível consumir a annotation em:</p>

<ul>
  <li>classes;</li>
  <li>atributos;</li>
  <li>métodos.</li>
</ul>

<p>No exemplo abaixo, temos a classe <strong>People</strong>, que comsumirá a <strong>PeopleAnnotation</strong>:</p>

<script src="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9.js?file=People.php"></script>

<p><span class="space"> </span></p>

<p>Repare que, a classe <strong>People</strong> está consumindo a <strong>annotation</strong> tanto na respectiva classe, quanto nos atributos e métodos.</p>

<h2 id="vamos-verificar-a-people-finalizando-a-sopa-de-letrinhas">Vamos verificar a <strong>People</strong>. Finalizando a sopa de letrinhas</h2>

<p>Nesta etapa final, iremos instanciar a classe <strong>AnnotationReader</strong> para lermos as <strong>annotations</strong> extraídas da classe <strong>People</strong> (que está consumindo a <strong>PeopleAnnotation</strong>).</p>

<p>Classes nativas utilizadas no exemplo:</p>

<ul>
  <li><strong><a href="http://php.net/manual/pt_BR/class.reflectionclass.php" target="_blank">ReflectionClass()</a></strong>;</li>
  <li><strong><a href="http://php.net/manual/pt_BR/class.reflectionobject.php" target="_blank">ReflectionObject()</a></strong>;</li>
  <li><strong><a href="http://php.net/manual/pt_BR/class.reflectionproperty.php" target="_blank">ReflectionProperty()</a></strong>;</li>
  <li><strong><a href="http://php.net/manual/pt_BR/class.reflectionmethod.php" target="_blank">ReflectionMethod()</a></strong>.</li>
</ul>

<p>Abaixo o exemplo:</p>

<script src="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9.js?file=ReaderAnnotation.php"></script>

<p><span class="space"> </span></p>

<h2 id="resultado-você-já-deve-ter-executado-os-exemplos">Resultado (você já deve ter executado os exemplos)</h2>

<p class="center"><img src="/img/posts/2016-01-custom-annotations/happy.gif" alt="alt text" title="Using the annotation PeopleAnnotation" /></p>

<script src="https://gist.github.com/leonardorifeli/9c12f94b109cb7859ca9.js?file=result.txt"></script>

<p><span class="space"> </span></p>

<h2 id="referências">Referências</h2>

<ol>
  <li><a href="http://masnun.com/2012/08/12/using-annotations-in-php-with-doctrine-annotation-reader.html" target="_blank">Artigo sobre o assunto em inglês</a></li>
  <li><a href="http://doctrine-common.readthedocs.org/en/latest/reference/annotations.html" target="_blank">Doctrine - Documentação oficial</a></li>
  <li><a href="http://php.net/" target="_blank">Documentação oficial PHP.net</a></li>
</ol>

<h2 id="conclusão">Conclusão</h2>

<p>A utilização de <strong>annotation</strong> pode facilitar diversas condições, salientando que, a necessidade de implementar <strong>custom annotation</strong> varia de situação. Use o bom senso de programador.</p>

<p>Quaisquer feedbacks serão bem-vindos, fique à vontade para comentar e/ou implementar alguma informação.</p>

<p>Até breve méros mortais e eternos aprendizes (todos somos).</p>
</section>
  

</article>

<!-- Disqus -->


<!-- Post navigation -->


    </div>
    
<script src="/assets/js/katex_init.js"></script>


<footer class="site-footer">
	<p class="text">
		Copyright &copy; Leonardo Rifeli | E-mail: <a href="mailto: leonardorifeli@gmail.com">leonardorifeli@gmail.com</a> | License: <a href="http://leonardorifeli.mit-license.org/" target="_blank">MIT License</a> | Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
	</p>
</footer>

  </body>
</html>
