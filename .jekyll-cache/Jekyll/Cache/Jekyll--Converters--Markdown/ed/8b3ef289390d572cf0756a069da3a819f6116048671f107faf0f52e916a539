I"®:<p>No desenvolvimento de aplicaÃ§Ãµes, podemos optar por usar mÃ¡quinas virtuais (VMs) para facilitar o gerenciamento e provisionamento de serviÃ§os. Para isso, podemos citar o Vagrant. Mas, o provisionamento de mÃ¡quinas virtuais demanda grande quantidade de tempo, alÃ©m do fato do consumo demasiado de espaÃ§o em disco, recursos em geral da mÃ¡quina que serÃ¡ o host.</p>

<h2 id="sumÃ¡rio">SumÃ¡rio</h2>

<ul>
  <li>IntroduÃ§Ã£o;</li>
  <li>Um pouco sobre virtualizaÃ§Ã£o;</li>
  <li>O que Ã© Docker;</li>
  <li>O que Ã© um contÃªiner;</li>
  <li>Namespaces;</li>
  <li>Algumas vantagens do Docker;</li>
  <li>Principais funcionalidades;</li>
  <li>Docker image;</li>
  <li>Dockerfile;</li>
  <li>Docker compose;</li>
  <li>ReferÃªncias;</li>
  <li>ConclusÃ£o.</li>
</ul>

<h2 id="introduÃ§Ã£o">IntroduÃ§Ã£o</h2>

<p>Sim, eu fiquei alguns meses sem escrever! Sorry!</p>

<p>Sem ressentimentos, o assunto deste artigo Ã© muito importante. Falaremos sobre virtualizaÃ§Ã£o, isso mesmo. Sim, eu sei que se fÃ´ssemos descrevÃª-lo em muitos detalhes, levarÃ­amos longos e diversos artigos. Portanto, o objetivo deste artigo Ã© trazer um â€œresumÃ£oâ€ sobre este assunto. Falarei sobre <strong>virtualizaÃ§Ã£o tradicional</strong>, <strong>virtualizaÃ§Ã£o por contÃªineres</strong> e apresentarei o <strong><a href="https://www.docker.com/" target="_blank">Docker</a></strong> (caso nÃ£o o conheÃ§a).</p>

<p>O objetivo deste artigo Ã© descrever as teorias por volta do tema, farei um segundo artigo, que serÃ¡ um <strong>na prÃ¡tica</strong> com o Docker.</p>

<p>Sem mais delongas, chega mais que vai ser muito foda!</p>

<h2 id="pegue-um-cafÃ©">Pegue um cafÃ©</h2>

<p>Corre lÃ¡ e pegue um pouco de cafÃ©, o assunto serÃ¡ bem interessante.</p>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/get-coffee.gif" />
</div>

<h2 id="um-pouco-sobre-virtualizaÃ§Ã£o">Um pouco sobre VirtualizaÃ§Ã£o</h2>

<p>No desenvolvimento de aplicaÃ§Ãµes, podemos optar por usar mÃ¡quinas virtuais (VMs) para facilitar o gerenciamento e provisionamento de serviÃ§os. Para isso, podemos citar o <a href="https://www.vagrantup.com/" target="_blank">Vagrant</a>. Mas, o provisionamento de mÃ¡quinas virtuais demanda grande quantidade de tempo, alÃ©m do fato do consumo demasiado de espaÃ§o em disco, recursos em geral da mÃ¡quina que serÃ¡ o host.</p>

<p>Assim surgiu o <a href="https://en.wikipedia.org/wiki/LXC" target="_blank">LXC</a>. O Linux Container, ou LXC, foi lanÃ§ado em 2008 e Ã© uma tecnologia que permite a criaÃ§Ã£o de mÃºltiplas instÃ¢ncias isoladas de um determinado sistema operacional. Ou seja, uma maneira de virtualizar aplicaÃ§Ãµes dentro de uma mÃ¡quina (hospedeira) usando todos os recursos disponÃ­veis no mesmo Kernel da mÃ¡quina
hospedeira.</p>

<p>Tendo como precursor, o comando <a href="https://en.wikipedia.org/wiki/Chroot" target="_blank">chroot</a>, que foi lanÃ§ado em 1979 pelo <a href="https://en.wikipedia.org/wiki/Version_7_Unix" target="_blank">Unix V7</a>, como intuito de segregar acessos de diretÃ³rios e evitar que os usuÃ¡rios possam acessar Ã  estrutura raiz <strong>(/)</strong>. Este conceito evoluiu alguns anos, com o lanÃ§amento do comando <a href="https://www.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;manpath=freebsd-release-ports" target="_blank">jail</a>, no SO <a href="https://www.freebsd.org/releases/4.0R/announce.html" target="_blank">FreeBSD 4</a>.</p>

<p>Com relaÃ§Ã£o Ã  virtualizaÃ§Ã£o, a diferenÃ§a estÃ¡ no fato do <strong>LXC</strong> nÃ£o necessitar de uma camada de sistema operacional para cada aplicaÃ§Ã£o. Como vocÃª pode verificar na imagem abaixo.</p>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/c-structure.png" />
</div>

<p>Ao compararmos o <strong>LXC</strong> com a <strong>virtualizaÃ§Ã£o tradicional</strong>, fica mais claro que uma aplicaÃ§Ã£o sendo executada em um LXC demanda muito menos recursos, consumindo menos espaÃ§o em disco e com um nÃ­vel de portabilidade muito mais abrangente.</p>

<h2 id="o-que-Ã©-o-docker">O que Ã© o Docker?</h2>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/docker.png" />
</div>

<p>Nasceu como um projeto da <a href="https://cloud.docker.com/" target="_blank">DotCloud</a>, uma empresa <strong>PaaS</strong> (Platform as a Service).</p>

<p>Basicamente, Docker Ã© uma plataforma open-source, escrita em <strong>Go</strong>, tendo como finalidade, criar e gerenciar ambientes isolados para aplicaÃ§Ãµes. O Docker garante que, cada contÃªiner tenha tudo que uma aplicaÃ§Ã£o precisa para ser executada.</p>

<p>Em outras palavras, o Docker Ã© uma ferramenta de empacotamento de uma aplicaÃ§Ã£o e suas dependÃªncias em um contÃªiner virtual que pode ser executado em um servidor linux.</p>

<h2 id="entÃ£o-docker-Ã©-uma-vm">EntÃ£o, Docker Ã© uma VM?</h2>

<p>NÃ£o, contÃªineres docker possuem uma arquitetura diferente que permite maior portabilidade e eficiÃªncia.</p>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/docker-system.png" />
</div>

<h2 id="tecnologias-e-ideias-utilizadas">Tecnologias e ideias utilizadas</h2>

<p>Cara, contÃªiner nÃ£o Ã© nada novo, Docker surgiu para facilitar o uso deles. Abaixo um resumo de tecnologia e o ano da primeira versÃ£o:</p>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/technologies-year.png" />
</div>

<h2 id="o-que-Ã©-um-contÃªiner">O que Ã© um contÃªiner?</h2>

<p>Vamos fazer uma comparaÃ§Ã£o prÃ¡tica. ContÃªiner nada mais Ã© que uma caixa de metal, onde Ã© colocado tudo o que couber. ContÃªineres possuem dimensÃµes e interfaces comuns, onde guindastes e guinchos podem ser acoplados para colocÃ¡-los em navios ou caminhÃµes.</p>

<p>Beleza e, no contexto do artigo?</p>

<p>A virtualizaÃ§Ã£o em contÃªineres Ã© muito mais leve, onde, temos cada contÃªiner como uma instÃ¢ncia isolada em um kernel de sistema operacional. Os contÃªineres possuem interfaces de redes virtuais, processos e sistemas de arquivos independentes.</p>

<p>Algumas caracterÃ­sticas de um contÃªiner Docker:</p>

<ul>
  <li>Dependente de uma imagem (falaremos logo abaixo);</li>
  <li>Geram novas imagens;</li>
  <li>Conectividade com o host e outros contÃªineres;</li>
  <li>ExecuÃ§Ãµes controladas, CPU, RAM, I/O, etc.</li>
</ul>

<h2 id="namespaces">Namespaces</h2>

<p>O Docker utiliza os recursos de <a href="https://en.wikipedia.org/wiki/Namespace" target="_blank">Namespaces</a> para dispor um espaÃ§o de funcionamento isolado para os contÃªineres. Contudo, quando um contÃªiner Ã© criado, tambÃ©m Ã© criado um conjunto de namespaces e este, por sua vez, cria uma camada para isolamento para os grupos de processos. Abaixo seguem os tipos de namespaces:</p>

<ul>
  <li><strong>PID:</strong> isolamento de processos.</li>
  <li><strong>NET:</strong> controle de interfaces de rede.</li>
  <li><strong>IPC:</strong> controle dos recursos de IPC (InterProcess Communication).</li>
  <li><strong>MNT:</strong> gestÃ£o de pontos de montagem.</li>
  <li><strong>UTC (Unix Timesharing System):</strong> provÃ©m todo o isolamento de recursos do kernel (justamente a camada de abstraÃ§Ã£o como mostra a imagem).</li>
</ul>

<h2 id="algumas-vantagens-do-docker">Algumas Vantagens do Docker</h2>

<ul>
  <li>Baixo overhead e tempo de boot;</li>
  <li>Kernel compartilhado com o Host;</li>
  <li>ContÃªineres rodam isoladamente;</li>
  <li>Facilidade de configuraÃ§Ã£o do ambiente de desenvolvimento para novos membros do time;</li>
  <li>Acabar com a histÃ³ria do â€œna minha mÃ¡quina funcionavaâ€.</li>
</ul>

<h2 id="principais-funcionalidades">Principais Funcionalidades</h2>

<ul>
  <li><strong>Versionamento</strong>: o Docker permite que vocÃª versione as alteraÃ§Ãµes de um contÃªiner. Isto permite verificar as diferenÃ§as entre versÃµes, fazer commit de novas versÃµes e atÃ© mesmo fazer rollback (isso Ã© muito importante haha).</li>
  <li><strong>Compartilhamento de imagens</strong>: sim, existe um repositÃ³rio de contÃªineres. O <strong>Docker Hub</strong>. Ele possui milhares de imagens com as mais diversas aplicaÃ§Ãµes. VocÃª pode rapidamente criar sua aplicaÃ§Ã£o com uma base jÃ¡ desenvolvida e ainda criar sua base e compartilhÃ¡-la na comunidade.</li>
  <li><strong>LicenÃ§a open-source</strong>: licenciado como <strong>Apache License 2.0</strong>, mantÃ©m os cÃ³digos fonte disponÃ­veis para facilitar o desenvolvimento colaborativo.</li>
  <li><strong>Hardware</strong>: exige poucos recursos de processos, memÃ³ria e espaÃ§o em disco.</li>
  <li><strong>ComunicaÃ§Ã£o entre contÃªineres</strong>: conectar contÃªineres via mapeamentos de porta <strong>TCP/IP</strong> nÃ£o Ã© a Ãºnica forma de disponibilizar recursos entre eles.</li>
</ul>

<p>E uma das principais:</p>

<div style="text-align:center">
	<img class="image" src="/img/posts/2016/11/03/dependency-hell.png" />
</div>

<ul>
  <li><strong>Evita Dependency Hell</strong>: um dos maiores problemas que os desenvolvedores de software convivem, Ã© o gerenciamento de dependÃªncias. O Docker evita problemas neste gerenciamento.</li>
</ul>

<h2 id="docker-image">Docker Image</h2>

<p>Uma imagem Docker nada mais Ã© que, um arquivo inerte, imutÃ¡vel, que Ã© essencialmente instanciado por um contÃªiner. As imagens sÃ£o criadas com o comando <strong>build</strong> (entrarei em mais detalhes na segunda parte do artigo) e elas serÃ£o consumidas por um contÃªiner, ou seja, um contÃªiner Ã© a instÃ¢ncia de uma imagem. Como as imagens podem ser muito grandes, as imagens sÃ£o projetadas para serem compostas por camadas de outras imagens.</p>

<p>Basicamente, uma imagem Ã© um conjunto de camadas que vocÃª descreve e, quando vocÃª inicia uma imagem, vocÃª terÃ¡ um contÃªiner em execuÃ§Ã£o desta imagem e vocÃª pode ter muitos contÃªineres da mesma imagem. Portanto, uma imagem em execuÃ§Ã£o Ã© um contÃªiner.</p>

<p>E como criar uma imagem, ou seja, como descrever as camadas de uma imagem? Chega maisâ€¦</p>

<h2 id="dockerfile">Dockerfile</h2>

<p>Bom, basicamente, <strong>Dockerfile</strong> Ã© um arquivo (ah vÃ¡!) que contÃ©m um conjunto de instruÃ§Ãµes necessÃ¡rias para se criar uma imagem <strong>Docker</strong>, ou seja, se vocÃª tiver o <strong>Dockerfile</strong> de uma imagem, basta modificar o que deseja e recriar a imagem â€œdo zeroâ€, sim, isso pode demorar um pouco mais, mas essa imagem serÃ¡ muito mais â€œenxutaâ€.</p>

<p>Caso nÃ£o tenha o <strong>Dockerfile</strong> (geralmente vocÃª irÃ¡ cair neste caso), vocÃª pode usar uma imagem Ã  sua escolha como base e entÃ£o criar a sua imagem como uma camada acima.</p>

<p><strong>Exemplo de Dockerfile:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FROM image[:tag] # de qual imagem irÃ¡ se basear
RUN command # o que serÃ¡ executado por um shel (ex: apt-get update)
WORKDIR /src # diretÃ³rio "raiz" para os comandos seguintes
COPY . /src # copia arquivos para dentro do contÃªiner
VOLUME /src # volumes compartilhados
EXPOSE 8080 # porta liberada para fora do contÃªiner
CMD [command, params]
</code></pre></div></div>

<p>Alguns links estÃ£o nas referÃªncias.</p>

<h2 id="docker-compose">Docker Compose</h2>

<p>Basicamente, Ã© uma ferramenta para a criaÃ§Ã£o e execuÃ§Ã£o de mÃºltiplos contÃªineres de aplicaÃ§Ã£o.</p>

<p>VocÃª utiliza um arquivo do tipo <strong>yaml</strong> para definir como serÃ¡ o ambiente de sua aplicaÃ§Ã£o. Sua aplicaÃ§Ã£o nÃ£o Ã© sozinha, ela poderÃ¡ depender de serviÃ§os como: banco de dados (MySQL, por exemplo), redis, php, java, etc (que estarÃ¡ em outro contÃªiner), imagine ter que subir todos estes contÃªineres (detalhe, antes de ter que subir o contÃªiner da sua aplicaÃ§Ã£o). O Docker Compose irÃ¡ facilitar isso. Ele Ã© Ã³timo para desenvolvimento, testes e homologaÃ§Ã£o, bem como para melhorar seu fluxo de integraÃ§Ã£o continua. Por exemplo:</p>

<ul>
  <li><strong>Ambiente de desenvolvimento</strong>: vocÃª pode simular todo o ambiente de produÃ§Ã£o, ou seja, precisando de outros serviÃ§os (conforme citado acima), basta definir isso em um arquivo .yml e quando vocÃª executar o Docker Compose, todo esse ambiente estarÃ¡ disponÃ­vel para vocÃª.</li>
</ul>

<p>Link da documentaÃ§Ã£o oficial estÃ¡ nas referÃªncias.</p>

<h2 id="gado-vs-animal-de-estimaÃ§Ã£o">Gado vs Animal de EstimaÃ§Ã£o</h2>

<p>Pense bem nessa diferenÃ§a. A sua infraestrutura deve ser composta de componentes que vocÃª possa tratar como gado: <strong>auto-suficientes</strong>, <strong>facilmente substituÃ­veis</strong> e <strong>gerenciÃ¡veis</strong>.</p>

<p>Isso mesmo, nÃ£o se apegue aos seus contÃªineres, eles podem subir, serem replicados, destruÃ­dos e gerenciados com uma flexibilidade muito maior.</p>

<h2 id="referÃªncias">ReferÃªncias</h2>

<ul>
  <li><a href="https://goto.docker.com/rs/929-FJL-178/images/Docker-for-Virtualization-Admin-eBook.pdf" target="_blank">Ebook - Docker for the virtualization admin</a></li>
  <li><a href="https://www.digitalocean.com/community/tutorials/como-instalar-e-utilizar-o-docker-primeiros-passos-pt" target="_blank">Como Instalar e Utilizar o Docker: Primeiros passos</a></li>
  <li><a href="https://docs.docker.com/" target="_blank">Docs about Docker</a></li>
  <li><a href="https://infoslack.com/docker/" target="_blank">Infoslack - Docker</a></li>
  <li><a href="http://www.slideshare.net/HugoPosca/talk-31-dockernivelandoconhecimento" target="_blank">Hugo Posca - Nivelando conhecimento</a></li>
  <li><a href="http://www.slideshare.net/HugoPosca/talk-32-docker-compose" target="_blank">Hugo Posca - Docker Compose</a></li>
  <li><a href="https://www.youtube.com/watch?v=0cDj7citEjE" target="_blank">LinuxTips - Docker Tutorial #1 - Docker, Containers, Images e muito mais!</a></li>
  <li><a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" target="_blank">Best practices for writing Dockerfiles</a></li>
  <li><a href="https://www.digitalocean.com/community/tutorials/docker-explained-using-dockerfiles-to-automate-building-of-images" target="_blank">Docker Explained: Using Dockerfiles to Automate Building of Images</a></li>
  <li><a href="https://github.com/kstaken/dockerfile-examples" target="_blank">Exemplos de Dockerfile</a></li>
  <li><a href="https://github.com/kstaken/dockerfile-examples/blob/master/mongodb/Dockerfile" target="_blank">Exemplo - Dockerfile do Mongodb</a></li>
  <li><a href="https://docs.docker.com/compose/" target="_blank">DocumentaÃ§Ã£o oficial do Compose</a></li>
</ul>

<h2 id="conclusÃ£o">ConclusÃ£o</h2>

<p>Bom, estou ciente que foi um post grande (comparado aos anteriores), talvez atÃ© um pouco cansativo, mas Ã© muito importante que se entenda a teoria para praticar. Publicarei outro post, com um conteÃºdo mais da prÃ¡tica e alguns exemplos, claro, com Docker meu amigo.</p>

<p>PeÃ§o que comentem sobre o que acharam deste artigo, o que esperam da segunda parte, enfim, qualquer feedback serÃ¡ importante para o desenvolvimento dos outros artigos.</p>
:ET